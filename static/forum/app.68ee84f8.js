(function(t){function e(e){for(var s,r,o=e[0],c=e[1],u=e[2],d=0,p=[];d<o.length;d++)r=o[d],a[r]&&p.push(a[r][0]),a[r]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);l&&l(e);while(p.length)p.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],s=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(s=!1)}s&&(i.splice(e--,1),t=r(r.s=n[0]))}return t}var s={},a={app:0},i=[];function r(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=s,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"01e1":function(t,e,n){"use strict";var s=n("38ac"),a=n.n(s);a.a},"0386":function(t,e,n){},"18b5":function(t,e,n){"use strict";var s=n("9f1f"),a=n.n(s);a.a},"356b":function(t,e,n){},"38ac":function(t,e,n){},4144:function(t,e,n){},"4f87":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var s=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("canvas",{attrs:{id:"bg"}}),n("header-bar"),n("transition",{attrs:{name:"changepage",mode:"out-in"}},[n("router-view",{staticClass:"content"})],1)],1)},i=[],r=(n("6c7b"),n("d225")),o=n("b0b4");function c(t,e){var n=function(){function t(e,n,s){Object(r["a"])(this,t),this.x=e,this.y=n,this.r=s||3,this.mx=2*Math.random()-1,this.my=2*Math.random()-1,this.lineColor="#ddd",this.color="#ddd"}return Object(o["a"])(t,[{key:"draw",value:function(){i.beginPath(i),i.arc(this.x,this.y,this.r,0,360),i.closePath,i.fillStyle=this.color,i.fill()}},{key:"drawcurrent",value:function(){i.beginPath(),i.arc(this.x,this.y,this.r,0,360),i.closePath,i.fillStyle=this.color,i.fill()}},{key:"move",value:function(){this.mx=this.x>0&&this.x<u?this.mx:-this.mx,this.my=this.y>0&&this.y<l?this.my:-this.my,this.x+=this.mx/2,this.y+=this.my/2}},{key:"line",value:function(t){var e=this.x-t.x,n=this.y-t.y,s=Math.sqrt(e*e+n*n);s<150&&(i.beginPath(),i.moveTo(this.x,this.y),i.lineTo(t.x,t.y),i.lineWidth=1,i.strokeStyle=this.lineColor,i.stroke(),i.closePath())}}]),t}();function s(){i.clearRect(0,0,u,l);for(var t=0;t<c.length;t++){c[t].draw();for(var e=0;e<c.length;e++)c[t].line(c[e]);c[t].move()}for(var n=0;n<c.length;n++)m.line(c[n]);return requestAnimationFrame(s)}var a=document.getElementById(t),i=a.getContext("2d"),c=[];a.width=1*a.offsetWidth,a.height=1*a.offsetHeight;for(var u=a.width,l=a.height,d=0;d<e;d++){var p=new n(Math.random()*u,Math.random()*l);c.push(p)}var m=new n(0,0,3);return a.addEventListener("mousemove",function(t){m.x=1*t.offsetX,m.y=1*t.offsetY}),s()}var u=c,l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header-bar"},[t.userId?n("div",{staticClass:"login-resign-btn",on:{click:t.goUserCenter,mouseover:function(e){t.maxHeight="150px"},mouseleave:function(e){t.maxHeight="0px"}}},[t._v(t._s(t.userName))]):n("div",{staticClass:"login-resign-btn",on:{click:t.showLoginBox}},[t._v("登录/注册")]),n("login",{staticClass:"login",attrs:{show:t.showLogin},on:{closeEvent:t.closeLogin}}),t.userId?n("div",{staticClass:"option",style:{maxHeight:t.maxHeight},on:{mouseover:function(e){t.maxHeight="150px"},mouseleave:function(e){t.maxHeight="0px"}}},[n("div",{staticClass:"option-item",on:{click:t.goUserCenter}},[t._v("个人中心")]),n("div",{staticClass:"option-item",on:{click:t.logout}},[t._v("退出登录")])]):t._e()],1)},d=[],p=n("cebc"),m=n("2f62"),v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"changepage",mode:"out-in"}},[t.show?n("div",{staticClass:"login-warp"},[n("div",{staticClass:"login-box"},[n("i",{staticClass:"close-btn el-icon-close",on:{click:t.close}}),n("h2",{staticClass:"title"},[t._v("论坛登录")]),n("div",{staticClass:"account-box"},[n("span",{staticClass:"account-title"},[t._v("帐号：")]),n("div",{staticClass:"input-warp",class:{focus:t.focusAccount}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.account,expression:"account"}],staticClass:"account-input",attrs:{type:"text"},domProps:{value:t.account},on:{focus:function(e){t.focusAccount=!0},blur:function(e){t.focusAccount=!1},input:function(e){e.target.composing||(t.account=e.target.value)}}})])]),n("div",{staticClass:"password-box"},[n("span",{staticClass:"password-title"},[t._v("密码：")]),n("div",{staticClass:"input-warp",class:{focus:t.focusPassword}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"password-input",attrs:{type:"password"},domProps:{value:t.password},on:{focus:function(e){t.focusPassword=!0},blur:function(e){t.focusPassword=!1},input:function(e){e.target.composing||(t.password=e.target.value)}}})])]),n("div",{staticClass:"login-btn",on:{click:t.login}},[t._v("登录")]),n("div",{staticClass:"more"},[n("span",{staticClass:"register",on:{click:t.goRegister}},[t._v("注册")]),n("span",{staticClass:"forget"},[t._v("忘记密码")])])])]):t._e()])},f=[],h=(n("7f7f"),n("96cf"),n("3b8d")),g=n("bc3a"),w=n.n(g),C=n("5c96"),_=n.n(C),b=n("8c4f"),x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"index"},[n("topic-tab",{attrs:{"topic-list":t.topicList},on:{select:t.selectTab}}),n("div",{staticClass:"post-list-box"},[n("div",{staticClass:"header"},[n("div",{staticClass:"title"},[t._v(t._s(t.selectTabTitle))]),n("span",{staticClass:"post-btn",on:{click:t.createPost}},[t._v("发帖")])]),n("div",{staticClass:"post-list"},t._l(t.postList,function(e){return n("div",{key:e.id,staticClass:"post-item"},[n("div",{staticClass:"first"},[n("div",{staticClass:"topic"},[t._v(t._s(e.topic.title))]),n("div",{staticClass:"user",on:{click:function(n){return t.showUser(e.id)}}},[t._v(t._s(e.user.name))]),n("UserPop",{attrs:{show:e.id==t.showPostId,userId:e.user.id},on:{close:function(e){t.showPostId=0}}})],1),n("div",{staticClass:"title",on:{click:function(n){return t.read(e.id)}}},[t._v(t._s(e.title))]),n("div",{staticClass:"last"},[n("div",{staticClass:"like"},[t._v("赞:"+t._s(e.like_count))]),n("div",{staticClass:"collect-count"},[t._v("收藏数："+t._s(e.collect_count))]),n("div",{staticClass:"time"},[t._v("时间："+t._s(e.updated_at))])])])}),0)])],1)},y=[],k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"topic-tab"},[n("div",{staticClass:"header"},[t._v("主题分类")]),n("div",{staticClass:"topic-list"},[n("div",{staticClass:"topic-item",on:{click:function(e){return t.select({id:0,title:"热门推荐"})}}},[t._v("热门推荐")]),t._l(t.topicList,function(e){return n("div",{key:e.id,staticClass:"topic-item",on:{click:function(n){return t.select(e)}}},[t._v(t._s(e.title))])})],2)])},$=[],P={name:"topic-tab",props:["topicList"],methods:{select:function(t){this.$emit("select",t)}}},j=P,O=(n("a152"),n("2877")),I=Object(O["a"])(j,k,$,!1,null,"4417e849",null),R=I.exports,E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-popover",{staticClass:"user-pop",attrs:{value:t.show,placement:"left",width:"220",transition:"showUserPop"}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"user-pop-content"},[n("i",{staticClass:"close-btn el-icon-close",on:{click:t.close}}),n("img",{staticClass:"user-avator",attrs:{src:t.user.avator}}),n("div",{staticClass:"user-name"},[t._v(t._s(t.user.name))]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.userId!=t.user.id,expression:"$store.state.userId!=user.id"}],staticClass:"follow-btn",attrs:{type:"primary",size:"mini",loading:t.sending},on:{click:function(e){return t.follow(t.user)}}},[n("i",{directives:[{name:"show",rawName:"v-show",value:t.user.id&&t.user["fans-list"].length>0||t.isFollow,expression:"((user.id && user['fans-list'].length>0)||isFollow)"}],staticClass:"el-icon-check el-icon--left"}),t._v("\n      "+t._s(t.user.id&&t.user["fans-list"].length>0||t.isFollow?"已关注":"关注")+"\n    ")]),n("div",{staticClass:"user-info"},[n("div",{staticClass:"user-sex"},[t._v("性别："+t._s(t.getSex(t.user.sex)))]),n("div",{staticClass:"user-follow"},[t._v("关注："+t._s(t.user.follow))]),n("div",{staticClass:"user-fans"},[t._v("粉丝："+t._s(t.user.fans))])])],1)])},L=[],S={props:["show","userId"],data:function(){return{isFollow:!1,user:{},loading:!0,sending:!1}},methods:{follow:function(){var t=this;this.sending=!0,this.user["fans-list"].length>0||this.isFollow?zt.unfollow(this.user.id).then(function(e){t.isFollow=!1,t.$message({message:"取消关注成功！",type:"success",center:!0}),t.sending=!1,t.$emit("unfollow",{userId:t.user.id}),t.user.fans--}):zt.follow(this.user.id).then(function(e){t.isFollow=!0,t.$message({message:"关注成功！",type:"success",center:!0}),t.sending=!1,t.$emit("follow",{userId:t.user.id}),t.user.fans++})},getSex:function(t){return 1==t?"男":2==t?"女":"保密"},close:function(){this.$emit("close")}},watch:{show:function(t,e){var n=this;t&&(this.loading=!0,this.sending=!1,this.isFollow=!1,this.user={},zt.getUser(this.userId).then(function(t){n.user=t.data,n.loading=!1}))}}},N=S,U=Object(O["a"])(N,E,L,!1,null,null,null),T=U.exports,A={components:{TopicTab:R,UserPop:T},data:function(){return{topicList:[],postList:[],selectTabTitle:"热门推荐",showPostId:0}},mounted:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:zt.getTopicList().then(function(t){e.topicList=t.data.rows}),zt.getPostList().then(function(t){e.postList=t.data.rows});case 2:case"end":return t.stop()}},t)}));function e(){return t.apply(this,arguments)}return e}(),methods:{selectTab:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){var n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.selectTabTitle=e.title,zt.getPostList(e.id).then(function(t){n.postList=t.data.rows});case 2:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),createPost:function(){this.$store.state.userId?this.$router.push({path:"/post"}):this.$message({message:"请先登录！",type:"warning",center:!0})},read:function(t){this.$router.push({path:"/post/"+t})},showUser:function(t){this.showPostId=t}}},M=A,F=(n("685a"),Object(O["a"])(M,x,y,!1,null,"c7a54f1e",null)),H=F.exports,B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"register-page"},[n("div",{staticClass:"title"},[t._v("用户注册")]),n("div",{staticClass:"line"}),n("div",{staticClass:"info-list"},[n("div",{staticClass:"info-item"},[n("span",{staticClass:"info-title"},[t._v("头像：")]),n("div",{staticClass:"upload-box"},[n("el-upload",{staticClass:"avatar-uploader",attrs:{action:"//39.108.174.110/api/v1/upload","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload,accept:"image/jpeg, image/png","on-error":t.handleError}},[t.avator?n("img",{staticClass:"avatar",attrs:{src:t.avator}}):n("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)]),n("div",{staticClass:"info-item"},[n("span",{staticClass:"info-title"},[t._v("帐号：")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.account,expression:"account"}],staticClass:"info-input",attrs:{type:"text"},domProps:{value:t.account},on:{input:function(e){e.target.composing||(t.account=e.target.value)}}})]),n("div",{staticClass:"info-item"},[n("span",{staticClass:"info-title"},[t._v("昵称：")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"info-input",attrs:{type:"text"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),n("div",{staticClass:"info-item"},[n("span",{staticClass:"info-title"},[t._v("密码：")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"info-input",attrs:{type:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),n("div",{staticClass:"info-item"},[n("span",{staticClass:"info-title"},[t._v("确认密码：")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.confirmPassword,expression:"confirmPassword"}],staticClass:"info-input",attrs:{type:"password"},domProps:{value:t.confirmPassword},on:{input:function(e){e.target.composing||(t.confirmPassword=e.target.value)}}})]),n("div",{staticClass:"info-item"},[n("span",{staticClass:"info-title"},[t._v("性别：")]),n("select",{directives:[{name:"model",rawName:"v-model",value:t.sex,expression:"sex"}],staticClass:"info-input",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.sex=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"1"}},[t._v("男")]),n("option",{attrs:{value:"2"}},[t._v("女")]),n("option",{attrs:{value:"0"}},[t._v("保密")])])])]),n("el-button",{staticClass:"register-btn",attrs:{type:"primary",loading:t.loading},on:{click:t.register}},[t._v("注册")])],1)},z=[],D={data:function(){return{account:"",name:"",password:"",confirmPassword:"",sex:"0",avator:"",loading:!1}},methods:{register:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,zt.register(this.account,this.password,this.confirmPassword,this.name,this.sex,this.avator).then(function(t){200==t.code&&(e.$message({message:"注册成功",type:"success",center:!0}),e.loading=!1,e.$router.push({path:"/"}))}).catch(function(t){e.loading=!1});case 3:t.sent;case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),handleError:function(t){this.$message.error("上传头像失败!")},handleAvatarSuccess:function(t,e){this.avator=t.data[0]},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type,n=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG或者PNG 格式!"),n||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&n}}},G=D,J=(n("c90d"),Object(O["a"])(G,B,z,!1,null,"50acba51",null)),q=J.exports,W=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-center"},[n("div",{staticClass:"title"},[t._v("个人中心")]),n("div",{staticClass:"line"}),n("div",{staticClass:"tab-list"},[n("div",{staticClass:"item",on:{click:function(e){return t.detail("info")}}},[t._v("个人信息")]),n("div",{staticClass:"item",on:{click:function(e){return t.detail("follow")}}},[t._v("我的关注")]),n("div",{staticClass:"item",on:{click:function(e){return t.detail("fans")}}},[t._v("我的粉丝")]),n("div",{staticClass:"item",on:{click:function(e){return t.detail("collection")}}},[t._v("我的收藏")])]),n("router-view",{staticClass:"content"})],1)},X=[],Y={props:["id"],data:function(){return{}},methods:{detail:function(t){this.$router.push({path:"/user/".concat(this.id,"/").concat(t)})}}},K=Y,Q=(n("a484"),Object(O["a"])(K,W,X,!1,null,"44bf9a06",null)),V=Q.exports,Z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-info"},[n("div",{staticClass:"info-list"},[n("div",{staticClass:"info-item"},[n("div",{staticClass:"upload-box"},[n("el-upload",{staticClass:"avatar-uploader",attrs:{action:"//39.108.174.110/api/v1/upload","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload,accept:"image/jpeg, image/png","on-error":t.handleError,disabled:!t.isEdit}},[t.avator?n("img",{staticClass:"avatar",attrs:{src:t.avator}}):n("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)]),n("div",{staticClass:"info-item"},[n("span",{staticClass:"info-title"},[t._v("帐号：")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.account,expression:"account"}],staticClass:"info-input",attrs:{type:"text",disabled:!0},domProps:{value:t.account},on:{input:function(e){e.target.composing||(t.account=e.target.value)}}})]),n("div",{staticClass:"info-item"},[n("span",{staticClass:"info-title"},[t._v("昵称：")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"info-input",attrs:{type:"text",disabled:!t.isEdit},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),n("div",{staticClass:"info-item"},[n("span",{staticClass:"info-title"},[t._v("性别：")]),n("select",{directives:[{name:"model",rawName:"v-model",value:t.sex,expression:"sex"}],staticClass:"info-input",attrs:{disabled:!t.isEdit},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.sex=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"1"}},[t._v("男")]),n("option",{attrs:{value:"2"}},[t._v("女")]),n("option",{attrs:{value:"0"}},[t._v("保密")])])]),this.$route.params.id==this.$store.state.userId?n("div",[t.isEdit?n("el-button",{staticClass:"save-btn",attrs:{type:"primary",loading:t.loading},on:{click:t.save}},[t._v("保存")]):n("el-button",{staticClass:"edit-btn",attrs:{type:"primary"},on:{click:t.edit}},[t._v("修改")])],1):t._e()])])},tt=[],et={data:function(){return{account:"",name:"",sex:"",avator:"",isEdit:!1,user:{},loading:!1}},mounted:function(){var t=this;zt.getUser(this.$route.params.id).then(function(e){t.account=e.data.account,t.name=e.data.name,t.sex=e.data.sex,t.avator=e.data.avator})},watch:{"$route.params.id":function(t,e){var n=this;t!=e&&zt.getUser(this.$route.params.id).then(function(t){n.account=t.data.account,n.name=t.data.name,n.sex=t.data.sex,n.avator=t.data.avator})}},updated:function(){},methods:{edit:function(){this.isEdit=!0},save:function(){var t=this;this.loading=!0,zt.updateUser(this.$route.params.id,{name:this.name,sex:this.sex,avator:this.avator}).then(function(e){t.isEdit=!1,t.loading=!1,t.$message({message:"修改成功！",type:"success",center:!0}),t.$store.commit("login",{id:t.$route.params.id,name:t.name}),window.localStorage.setItem("user_id",t.$route.params.id),window.localStorage.setItem("user_name",t.name)}).catch(function(e){t.loading=!1})},handleError:function(t){this.$message.error("上传头像失败!")},handleAvatarSuccess:function(t,e){this.avator=t.data[0],console.log(this.avator)},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type,n=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG或者PNG 格式!"),n||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&n}}},nt=et,st=(n("59b6"),Object(O["a"])(nt,Z,tt,!1,null,"73a733d0",null)),at=st.exports,it=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-follow"},[t._v("我的关注")])},rt=[],ot={},ct=ot,ut=Object(O["a"])(ct,it,rt,!1,null,null,null),lt=ut.exports,dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-fans"},[t._v("我的粉丝")])},pt=[],mt={},vt=mt,ft=Object(O["a"])(vt,dt,pt,!1,null,null,null),ht=ft.exports,gt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-collection"},[t._v("我的收藏")])},wt=[],Ct={},_t=Ct,bt=Object(O["a"])(_t,gt,wt,!1,null,null,null),xt=bt.exports,yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"create-post"},[n("div",{staticClass:"title"},[t._v("发布帖子")]),n("div",{staticClass:"title-warp"},[n("span",[t._v("标题：")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"input",attrs:{type:"text",placeholder:"输入标题..."},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})]),n("div",{staticClass:"topic-warp"},[n("span",[t._v("主题：")]),n("select",{directives:[{name:"model",rawName:"v-model",value:t.topic,expression:"topic"}],staticClass:"input",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.topic=e.target.multiple?n:n[0]}}},t._l(t.topicList,function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.title))])}),0)]),t._m(0),n("div",{staticClass:"submit-btn",on:{click:t.submit}},[t._v("发布")])])},kt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor-warp"},[n("div",{attrs:{id:"editor-tool"}}),n("div",{attrs:{id:"editor"}})])}],$t=n("1a0b"),Pt=n.n($t),jt={data:function(){return{topicList:[],title:"",topic:"",content:""}},beforeRouteEnter:function(t,e,n){n(function(t){t.$store.state.userId||t.$router.push({path:"/"})})},mounted:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=new Pt.a("#editor-tool","#editor"),e.customConfig.uploadImgMaxSize=2097152,e.customConfig.onchange=function(t){n.content=t},e.customConfig.customUploadImg=function(t,e){var n=new FormData;n.append("file",t[0]),zt.upload(n).then(function(t){e(t.data[0])})},e.customConfig.customAlert=function(t){alert("上传错误："+t)},e.create(),e.txt.html(this.content),zt.getTopicList().then(function(t){n.topicList=t.data.rows}).catch(function(t){n.$message({message:"获取主题列表失败",type:"error",center:!0})});case 8:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),methods:{submit:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:zt.createPost(this.topic,this.title,this.content).then(function(t){e.$message({message:"获取主题列表失败",type:"error",center:!0}),e.$router.push({path:"/"})});case 1:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}},Ot=jt,It=(n("01e1"),Object(O["a"])(Ot,yt,kt,!1,null,null,null)),Rt=It.exports,Et=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"post-detail"},[n("div",{staticClass:"title"},[t._v(t._s(t.post&&t.post.title))]),n("div",{staticClass:"middle"},[n("div",{staticClass:"type"},[t._v("主题："+t._s(t.post&&t.post.topic.title))]),n("div",{staticClass:"author"},[t._v("作者："+t._s(t.post&&t.post.user.name))])]),n("div",{staticClass:"foot"},[n("div",{staticClass:"time"},[t._v("时间："+t._s(t.post&&t.post.created_at))]),n("div",{staticClass:"like"},[t._v("赞:"+t._s(t.post&&t.post.like_count))]),n("div",{staticClass:"collection"},[t._v("收藏："+t._s(t.post&&t.post.collect_count))])]),n("div",{staticClass:"content",domProps:{innerHTML:t._s(t.post&&t.post.content)}}),n("hr",{staticClass:"line"}),n("div",{staticClass:"comment-header"},[t._v("- 评论列表 -")]),n("div",{staticClass:"comment-list"},[n("div",{staticClass:"comment-add",on:{click:t.addComment}},[t._v("添加评论")]),n("div",{class:t.showCommentNew?"show-comment-new-warp":"comment-new-warp"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.commentContent,expression:"commentContent"}],staticClass:"comment-new",attrs:{placeholder:"请输入回复内容..."},domProps:{value:t.commentContent},on:{input:function(e){e.target.composing||(t.commentContent=e.target.value)}}}),n("div",{staticClass:"btn-list"},[n("el-button",{attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),n("el-button",{staticClass:"comfirm-btn",attrs:{type:"primary",size:"mini",loading:t.sending},on:{click:t.sendComment}},[t._v("确认")])],1)]),t._l(t.commentList,function(e){return n("div",{key:e.id,staticClass:"comment-item"},[n("div",{staticClass:"comment-user",on:{click:function(n){return t.showUser(e.id)}}},[n("img",{staticClass:"comment-user-avator",attrs:{src:e.user.avator}}),n("div",{staticClass:"comment-user-name"},[t._v(t._s(e.user.name))])]),n("UserPop",{attrs:{show:e.id==t.showCommentId,userId:e.user.id},on:{close:function(e){t.showCommentId=0}}}),n("div",{staticClass:"right"},[n("div",{staticClass:"comment-created-at"},[t._v(t._s(e.created_at))]),n("div",{staticClass:"comment-like"},[t._v("👍("+t._s(e.like_count)+")")]),n("div",{staticClass:"comment-content"},[t._v(t._s(e.content))])])],1)})],2),n("el-pagination",{staticClass:"pagination",attrs:{layout:"prev, pager, next",total:t.totalCommentCount}})],1)},Lt=[],St={props:["id"],components:{UserPop:T},data:function(){return{post:null,commentList:[],showCommentNew:!1,commentContent:"",sending:!1,showCommentId:0,totalCommentCount:0}},mounted:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:zt.postDetail(this.id).then(function(t){e.post=t.data}).catch(function(t){e.$message({message:"资源不存在",type:"error",center:!0}),e.$router.push({path:"/"})}),zt.getCommentList(this.id).then(function(t){e.commentList=t.data.rows,e.totalCommentCount=t.data.count});case 2:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),methods:{addComment:function(){this.showCommentNew=!0},cancel:function(){this.showCommentNew=!1,this.commentContent=""},sendComment:function(){var t=this;this.sending=!0,zt.addComment(this.id,this.commentContent).then(function(e){t.$message({message:"回复成功",type:"success",center:!0}),t.commentContent="",t.sending=!1}).then(function(){return zt.getCommentList(t.id)}).then(function(e){t.commentList=e.data.rows,t.totalCommentCount=e.data.count}).catch(function(e){t.sending=!1})},showUser:function(t){this.showCommentId=t}}},Nt=St,Ut=(n("a28e"),Object(O["a"])(Nt,Et,Lt,!1,null,null,null)),Tt=Ut.exports;s["default"].use(b["a"]);var At=new b["a"]({routes:[{path:"/",name:"indexPage",component:H},{path:"/register",name:"registerPage",component:q},{path:"/user/:id",name:"userCenter",component:V,props:!0,children:[{path:"info",component:at},{path:"follow",component:lt},{path:"fans",component:ht},{path:"collection",component:xt}]},{path:"/post",name:"createPost",component:Rt},{path:"/post/:id",name:"postDetail",component:Tt,props:!0}]}),Mt=window.localStorage.getItem("access_token");w.a.defaults.headers.common["access_token"]=Mt,w.a.interceptors.response.use(function(t){var e=t.data;if(!e||e.code&&200!=e.code){Object(C["Message"])({message:"Error".concat(e.code&&"(".concat(e.code,")")," : ").concat(e.message||"未知错误"),center:!0,type:"error"});var n=new Error;throw n.code=e.code||500,n.errMsg=e.message||"未知错误",n}return e},function(t){var e,n="";if(t&&t.response)switch(t.response.status){case 400:n="请求错误";break;case 401:n="未授权，请登录";break;case 403:n="拒绝访问";break;case 404:n="请求地址出错: ".concat(t.response.config.url);break;case 408:n="请求超时";break;case 500:n="服务器内部错误";break;case 501:n="服务未实现";break;case 502:n="网关错误";break;case 503:n="服务不可用";break;case 504:n="网关超时";break;case 505:n="HTTP版本不受支持";break;default:n="未知错误"}return e=t&&t.response&&t.response.data&&t.response.data.code||t.response.status||500,n=t&&t.response&&t.response.data&&t.response.data.message||n||"未知错误",401==e?(Object(C["Message"])({message:"登录信息已过期，请重新登录",center:!0,type:"error"}),window.localStorage.removeItem("user_id"),window.localStorage.removeItem("user_name"),window.localStorage.removeItem("access_token"),At.push({path:"/"})):Object(C["Message"])({message:"Error".concat(e&&"(".concat(e,")")," : ").concat(n),center:!0,type:"error"}),Promise.reject({code:e,errMsg:n})});var Ft=w.a,Ht="//39.108.174.110/api/v1",Bt=Ht,zt={getTopicList:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ft.get(Bt+"/topic");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));function e(){return t.apply(this,arguments)}return e}(),getPostList:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e,n=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:0,t.next=3,Ft.get(Bt+"/post?topicId=".concat(e));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}));function e(){return t.apply(this,arguments)}return e}(),login:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e,n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ft.post(Bt+"/login",{account:e,password:n});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));function e(e,n){return t.apply(this,arguments)}return e}(),register:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e,n,s,a,i,r){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ft.post(Bt+"/user",{account:e,password:n,confirmPassword:s,name:a,sex:i,avator:r});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));function e(e,n,s,a,i,r){return t.apply(this,arguments)}return e}(),getUser:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ft.get(Bt+"/user/".concat(e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}(),updateUser:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e,n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ft.put(Bt+"/user/".concat(e),Object.assign({action:"UPDATE_INFO"},n));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));function e(e,n){return t.apply(this,arguments)}return e}(),createPost:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e,n,s){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ft.post(Bt+"/post",{topicId:e,title:n,content:s});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));function e(e,n,s){return t.apply(this,arguments)}return e}(),upload:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ft.post(Bt+"/upload",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}(),postDetail:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ft.get(Bt+"/post/".concat(e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}(),getCommentList:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ft.get(Bt+"/comment?postId=".concat(e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}(),addComment:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e,n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ft.post(Bt+"/comment",{postId:e,content:n});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));function e(e,n){return t.apply(this,arguments)}return e}(),follow:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ft.get(Bt+"/follow?userId=".concat(e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}(),unfollow:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ft.get(Bt+"/unfollow?userId=".concat(e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}()},Dt={name:"login",props:["show"],mounted:function(){},data:function(){return{account:"",password:"",focusAccount:!1,focusPassword:!1}},methods:{close:function(){this.$emit("closeEvent",!1)},login:function(){var t=Object(h["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:zt.login(this.account,this.password).then(function(t){e.$store.commit("login",{id:t.data.id,name:t.data.name}),window.localStorage.setItem("access_token",t.data.token),window.localStorage.setItem("user_id",t.data.id),window.localStorage.setItem("user_name",t.data.name),e.$message({message:"登录成功",type:"success",center:!0}),e.close()});case 1:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),goRegister:function(){this.close(),this.$router.push({path:"/register"})}}},Gt=Dt,Jt=(n("cfb4"),Object(O["a"])(Gt,v,f,!1,null,"57d1f378",null)),qt=Jt.exports,Wt={components:{login:qt},data:function(){return{showLogin:!1,maxHeight:0}},computed:Object(p["a"])({},Object(m["b"])(["userId","userName"])),methods:{showLoginBox:function(){this.showLogin=!0},closeLogin:function(){this.showLogin=!1},goUserCenter:function(){this.$router.push({path:"/user/".concat(this.userId,"/info")})},logout:function(){this.$store.commit("logout"),window.localStorage.removeItem("user_id"),window.localStorage.removeItem("user_name"),window.localStorage.removeItem("access_token"),this.$router.push({path:"/"})}}},Xt=Wt,Yt=(n("18b5"),Object(O["a"])(Xt,l,d,!1,null,"69131907",null)),Kt=Yt.exports,Qt={name:"App",components:{HeaderBar:Kt},mounted:function(){u("bg",80)}},Vt=Qt,Zt=(n("c9da"),Object(O["a"])(Vt,a,i,!1,null,"2f7f2ee1",null)),te=Zt.exports;s["default"].use(m["a"]);var ee=new m["a"].Store({state:{userId:"",userName:""},mutations:{login:function(t,e){t.userId=e.id,t.userName=e.name},logout:function(t){t.userId="",t.userName=""}},actions:{}});n("0fae"),n("4f87");s["default"].use(_.a),s["default"].config.productionTip=!1;var ne=window.localStorage.getItem("user_id"),se=window.localStorage.getItem("user_name");ne&&se&&ee.commit("login",{id:ne,name:se}),new s["default"]({router:At,store:ee,render:function(t){return t(te)}}).$mount("#app")},"59b6":function(t,e,n){"use strict";var s=n("85f7"),a=n.n(s);a.a},"5e10":function(t,e,n){},"685a":function(t,e,n){"use strict";var s=n("4144"),a=n.n(s);a.a},"85f7":function(t,e,n){},"9f1f":function(t,e,n){},a152:function(t,e,n){"use strict";var s=n("c95c"),a=n.n(s);a.a},a28e:function(t,e,n){"use strict";var s=n("e752"),a=n.n(s);a.a},a484:function(t,e,n){"use strict";var s=n("356b"),a=n.n(s);a.a},c90d:function(t,e,n){"use strict";var s=n("ca61"),a=n.n(s);a.a},c95c:function(t,e,n){},c9da:function(t,e,n){"use strict";var s=n("5e10"),a=n.n(s);a.a},ca61:function(t,e,n){},cfb4:function(t,e,n){"use strict";var s=n("0386"),a=n.n(s);a.a},e752:function(t,e,n){}});
//# sourceMappingURL=app.68ee84f8.js.map